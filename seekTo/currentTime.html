
<!doctype html>
<html>
<head>
	<title></title>
	<link href="css/jquery-ui-1.10.2.custom.min.css" rel="stylesheet" />
<style>
#seek-slider {
	width: 450px;
	display: inline-block;
}

.ui-slider .ui-slider-handle {
	width: 5px;
}
</style>
</head>
<body>



<div id="wrapper">

	<div id="player">
		<div id="ytplayer-object"></div>
	</div>

	<div id="controller">
		<ul class="clearfix">
			<li id="movie-title"></li>
			<li><span id="current-time"></span> / <span id="duration"></span></li>
		</ul>

		<ul class="clearfix">
			<li><a href="#" onclick="return ytPlayerPlay();" class="icon-">play</a></li>
			<li><a href="#" onclick="return ytPlayerPause();" class="icon-">pause</a></li>
			<li><span id="seek-slider"></span></li>
		</ul>
	</div>

</div>


	<script src="//code.jquery.com/jquery-latest.min.js"></script>
	<script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
	<script src="../js/swfobject.js"></script>

<script>

var movieId = null;
var ytplayer = null;
var haveMovieData = false;

/**
 * プレイヤーを埋め込む
 */
function embedYouTubeMovie(id) {
	movieId = id;
	var youtubeUrl = 'http://www.youtube.com/apiplayer?enablejsapi=1&version=3&playerapiid=ytplayer';
	var params = { allowScriptAccess: "always" };
	var atts = { id: "ytplayer" };
	var flashvars = {};
	swfobject.embedSWF(youtubeUrl, "ytplayer-object", "700", "393", "9", null, flashvars, params, atts);
}

/**
 * プレイヤーが再生準備ができたら呼ばれる関数
 */
function onYouTubePlayerReady(playerId) {
	ytplayer = document.getElementById(playerId);
	// プレーヤーの状態が変わった際に発生
	ytplayer.addEventListener('onStateChange', 'onYouTubePlayerStateChange');
	// ytplayer.addEventListener('onError', 'onYouTubePlayerError');
	ytplayer.cueVideoById(movieId);
	getMovieData(movieId);
}

function onYouTubePlayerStateChange(state) {
	currentTimeInterval = setInterval(setCurrentTime, 1000);
}

embedYouTubeMovie('s-t1tifeImw');

/*
//Play
function ytPlayerPlay() {
	if (ytplayer) {
		ytplayer.playVideo();
	}
	return false;
}

//Pause
function ytPlayerPause() {
	if (ytplayer) {
		ytplayer.pauseVideo();
	}
	return false;
}
*/

//seek
function ytPlayerSeek(sec) {
	if (ytplayer) {
		ytplayer.seekTo(parseInt(sec), true);
	}
	return false;
}


function setMovieInfo(duration) {
	if (ytplayer && !haveMovieData) {
		currentTime = document.getElementById('current-time');
		currentTime.innerHTML = getTimeString(ytplayer.getCurrentTime());
		if (!duration) {
			duration = ytplayer.getDuration();
		}
		document.getElementById('duration').innerHTML = getTimeString(duration);

		if (!seekSlider) {
			setSeekSlider();
		}
		haveMovieData = true;
	}
}

function getTimeString(s) {
	s = Math.ceil(s);
	var time = ('0' + Math.floor(s / 60)).slice(-2) + ':' + ('0' + (s % 60)).slice(-2);
	return time;
}

function setCurrentTime() {
	var time = ytplayer.getCurrentTime();
	currentTime.innerHTML = getTimeString(time);
	seekSlider.slider('value', time)
}




function setSeekSlider(maxVal) {
	if (!maxVal) {
		maxVal = ytplayer.getDuration();
	}
	seekSlider = $('#seek-slider').slider({
		min: 0,
		max: maxVal,
		slide: function(event, ui) {
			ytPlayerSeek(ui.value);
		}
	});
	seekSlider.slider({value: ytplayer.getCurrentTime()});
}

function getMovieData(id) {
	$.ajax({  
		url: 'http://gdata.youtube.com/feeds/api/videos/' + id + '?alt=json',
		type: 'get',
		dataType: 'json', 
		timeout: 2000,
		success: function(movieData, status) {
			if (status === 'success') {
				$('#movie-title').html(movieData.entry.title.$t);
				setSeekSlider(parseInt(movieData.entry.media$group.yt$duration.seconds));
				setMovieInfo(parseInt(movieData.entry.media$group.yt$duration.seconds));
			}
		},
		error: function(XMLHttpRequest, status, errorThrown) {
			return false;
		}
	});
}

</script>


	
</body>
</html>